#!/bin/bash

db2 +p -t <<EOF
   CONNECT TO SAMPLE;

   DROP VIEW ADDRESS_VW;
   DROP VIEW CUSTOMER_VW;
   
   DROP TABLE ADDRESS;
   DROP TABLE CUSTOMER;
  
   CREATE TABLE CUSTOMER(
        ID         INTEGER NOT NULL PRIMARY KEY,
        FIRSTNAME  VARCHAR(128),
        LASTNAME   VARCHAR(128),
        MIDDLENAME VARCHAR(128),
        AGE        INTEGER,
        BIRTHDATE  DATE,
        WAKEUP     TIME,
        UPDATED    TIMESTAMP,
        RAWDATA    CLOB);

  CREATE TABLE ADDRESS(
         CUSTOMER_ID INTEGER NOT NULL,
         STREET      VARCHAR(128),
         BLOCK       INTEGER,
         TYPE        CHAR(1),
         COUNTRY      VARCHAR(64),
        FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(ID)
      );

  CREATE VIEW ADDRESS_VW AS SELECT CUSTOMER_ID,STREET,BLOCK,TYPE,COUNTRY FROM(
    SELECT CUSTOMER_ID,STREET,BLOCK,TYPE,COUNTRY FROM ADDRESS ORDER BY 1,2,3,4);
    
  CREATE VIEW CUSTOMER_VW AS SELECT ID,FIRSTNAME,LASTNAME,MIDDLENAME,BIRTHDATE,WAKEUP,UPDATED,AGE,RAWDATA FROM(
  	 SELECT ID,FIRSTNAME,LASTNAME,MIDDLENAME,BIRTHDATE,WAKEUP,UPDATED,AGE,RAWDATA FROM CUSTOMER ORDER BY 1);
  
EOF
