#!/bin/bash


psql ${IAS_TEST_DS_POSTGRESQL_DB} <<EOF

   DROP VIEW ADDRESS_VW;
   DROP VIEW CUSTOMER_VW;

   DROP TABLE ADDRESS;
   DROP TABLE CUSTOMER;

   CREATE TABLE CUSTOMER(
        ID         INTEGER PRIMARY KEY,
        FIRSTNAME  VARCHAR(128),
        LASTNAME   VARCHAR(128),
        MIDDLENAME VARCHAR(128),
        AGE        INTEGER,
        BIRTHDATE  DATE,
        WAKEUP     TIME,
        UPDATED    TIMESTAMP,
        RAWDATA    TEXT);

  CREATE TABLE ADDRESS(
         "CUSTOMER_ID" INTEGER,
         STREET        VARCHAR(128),
         BLOCK       INTEGER,
         TYPE        CHAR(1),
         COUNTRY     VARCHAR(64),
        FOREIGN KEY ("CUSTOMER_ID") REFERENCES CUSTOMER(ID)
      );

  CREATE VIEW ADDRESS_VW AS SELECT * FROM ADDRESS ORDER BY 1,2,3,4;
  CREATE VIEW CUSTOMER_VW AS SELECT * FROM CUSTOMER ORDER BY 1;

CREATE OR REPLACE PROCEDURE TESTADD(IN A1 INTEGER, INOUT A2 INTEGER, INOUT A3 INTEGER)
AS \$\$
BEGIN
   A2 = A1;
   A3 = 22 * A2;
END;
\$\$
LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION GETNUM(IN id INTEGER, OUT result INTEGER)
AS \$\$
 BEGIN
   result = 100 * id;
 END
\$\$
LANGUAGE plpgsql;

EOF
